<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="npg_view_import_data_form" model="ir.ui.view">
            <field name="name">import.data.form</field>
            <field name="model">import.data.file</field>
            <field name="arch" type="xml">
                <form string="Read File" version="7.0">
                    <group>
                    
                    <group >
                    	<field name="name"/>
                        <field name="model_id" on_change="onchange_model(model_id)"/>
                    	<field name="has_errors" readonly="1"/>
                    	
                    	<field name="attachment" widget="many2many_binary" />
                        <field name="dbf_path"/>
                    </group>   
                    <group>    
                        <field name="start_time" string="Started"/>
                    	<field name="end_time"/>
                    	
                    </group>
                    
                    <newline/>
                    
                    <group col="8">
                    
                    	 <group colspan='2'>
                    	 	<button name='action_get_headers' string="Load Header Fields" 
                    	 		context="{'model':model_id}" 
                    	 		type="object" class="oe_highlight"
                    	 		confirm="???Are you Sure??? This will overrite any changes made to Field Mappings"/>
                    	 	<newline/>
                    		<button name="action_import" string="Run Test" type="object" class="oe_highlight" context="{'test':True}"/>
                    		<newline/>
                    		<button name="action_import" string="Import Data" type="object" class="oe_highlight" />
	                        <newline/> 
	                    	      
                         </group >
                         <group colspan="2">
					
                         	<newline/>
                         	<field name="test_sample_size" />
                         	<field name="rollback"/>
                        	<field name="do_update" />
                          	<field name="record_external" string="External Id from Row #" on_change="onchange_record_external(record_external)"/>
                          	<field name="external_id_field" string="External Id from Field"
                          		attrs="{'invisible':[('record_external','=',True)]}" on_change="onchange_external_id_field(external_id_field)"/>
                          	
                         </group>
                         <group col = "4">
                         	<label for="description"/>
                         	<field name='description' nolabel="1" colspan='4' />
                         	<group col="6" colspan='6' string="Current Record Displayed">
                         		<newline/>
		                         <button name="record_backward" type="object" icon="gtk-go-back" colspan="1"/>
		                    	 <button name="record_forward" type="object" icon="gtk-go-forward" colspan="1"/>
		           
		                    	 <field name="record_num" on_change="onchange_record_num(record_num)"/>

		                    	 <field name="tot_record_num" />
		                    	 
	                   	 	</group>
                         </group>                         

                    </group>
                    </group>  
                    
                    	<notebook>
                    	<page string="Field Map" name="field_map" >
                    	
                          <field name="header_ids" context="{'model':model_id}" nolabel="1"> 
                          	 <form string="Headers">
                          	 	<group>
	                    		<field name="name"/>	                    	
	                    		<field name="field_label"/>
	                    		<field name="field_type"/>
	                    	 	<field name="field_val" />
	                    		<field name="is_unique"/>
	                    		<field name="is_unique_external"/>
	                    		<field name="default_val"/>
	                    		<field name="create_related"/>
	                    	 	<field name="model" required="0" readonly="1" />
	                    		<field name="model_field" required="0" domain="[('model_id','=',model)]"
	                    				context = "{'manual':True, 'default_model_id':model}"
	                    				on_change="onchange_model_field(model_field)"/>
	                    		<field name="model_field_name" />
	                    		<field name="model_field_type" readonly="1" />
                      			<field name="m2o_substituions" attrs="{'invisible':[('model_field_type','!=','many2one')]}">
		                  			<tree editable="bottom">
		                  				<field name="src_value"/>	                    	
		                  				<field name="odoo_value"/>
		                  			</tree>
		                  		</field>
	                    		<field name="relation" readonly="1"/>
	                    		<field name="relation_field" readonly="1"/>
	                    		<field name="relation_search_field"/>
	                    		<field name="search_domain"/> 
	                    		</group>	
	                    	</form> 
                          
	                  	<tree  >
	                    		<field name="name"/>
	                    		<field name="field_label"/>
	                    		<field name="field_type"/>
	                    	 	<field name="field_val" />
	                    	 	<field name="default_val"/>
	                    	 	<field name="model" required="0" readonly="1" invisible='1'/>
	                    		<field name="model_field" required="0" domain="[('model_id','=',model)]"/>
	                    	</tree>  
	                    </field> 
					
	                </page>   
	        		<page string="Error Log" name="error_log">
	                    <group colspan="1">
	                    	<field name="error_log"/>  
	                    </group>
 					</page>
 				</notebook>
                </form>
            </field>
        </record>
        
        <record id="view_import_data_tree" model="ir.ui.view">
            <field name="name">import.data.tree</field>
            <field name="model">import.data.file</field>
            <field name="arch" type="xml">
                <tree string="Import Data Files" version="7.0">
                    	<field name="name"/>
                        <field name="tot_record_num" />
                        <field name="start_time" />
                        <field name="end_time" />
                        <field name="has_errors" />
                        <field name="error_log" />
                 </tree>
            </field>
        </record>

        <record id="view_import_data_filter" model="ir.ui.view">
            <field name="name">import.data.filter</field>
            <field name="model">import.data.file</field>
            <field name="arch" type="xml">
                <search string="Search Import Data">
                	<field name="name" />
                	<field name="has_errors"/>
                	<filter string="No Errors" domain="[('has_errors','=',False)]" name="no_errors_filter"/>
                	<filter string="Has Errors" domain="[('has_errors','=',True)]" name="has_errors_filter"/>
                </search>
            </field>
        </record>
        
       <record id="npg_view_import_data_header_form" model="ir.ui.view">
            <field name="name">import.data.header.form</field>
            <field name="model">import.data.header</field>
            <field name="arch" type="xml">
                <form string="Read File" version="7.0">   
        
            	 <form string="Headers">
                     <group>
                  		<field name="name"/>	                    	
                  		<field name="field_label"/>
                  		<field name="field_type"/>
                  	 	<field name="field_val" />
                  		<field name="is_unique"/>
                  		<field name="is_unique_external"/>
                  		<field name="default_val"/>
                  		<field name="create_related"/>
                  	 	<field name="model" required="0" readonly="1" />
                  		<field name="model_field" required="0" domain="[('model_id','=',model)]"
                  				context = "{'manual':True, 'default_model_id':model}"
                  				on_change="onchange_model_field(model_field)"/>
                  		<field name="model_field_name" />
                  		<field name="model_field_type" readonly="1" />
                  		<field name="relation" readonly="1"/>
                  		<field name="relation_field" readonly="1"/>
                  		<field name="search_domain"/> 
                  		<field name="m2o_substituions" attrs="{'invisible':[('model_field_type','!=','many2one')]}">
                  			<tree editable="bottom">
                  				<field name="src_value"/>	                    	
                  				<field name="odoo_value"/>
                  			</tree>
                  		</field>
                  		</group>	
                  	</form>
                </form>
            </field>
        </record>   
        
        <record id="npg_view_import_data_header_tree" model="ir.ui.view">
            <field name="name">import.data.header.tree</field>
            <field name="model">import.data.header</field>
            <field name="arch" type="xml">  
              	    <tree string= "Header Mappings" >
                 		<field name="name"/>
                 		<field name="field_label"/>
                 		<field name="field_type"/>
                 	 	<field name="field_val" />
                 	 	<field name="default_val"/>
                 	 	<field name="model" required="0" readonly="1" invisible='1'/>
                 		<field name="model_field" required="0" domain="[('model_id','=',model)]"/>
                 	</tree> 
                 	
            </field>
        </record> 	
	    
	    <record id="npg_view_import_data_header_search" model="ir.ui.view">
            <field name="name">import.data.header.search</field>
            <field name="model">import.data.header</field>
            <field name="arch" type="xml">
            	<search>
            		<field name="name"></field>
            		<field name="model_field"></field>
            		<field name="import_data_id"/>
            		<filter string="Odoo Field Not Set" domain="[('model_field','=',False)]" name="no_model_field_filter"/>
                	<filter string="Odoo Field Set" domain="[('model_field','!=',False)]" name="yes_model_field_filter"/>
                	<group string="Group By" expand="0">
                		
                		<filter string="Model" domain="[]" context="{'group_by':'model'}" name="group_by_model"/>
                		<filter string="Data Source" domain="[]" context="{'group_by':'import_data_id'}" name="group_by_import_data_id"/>
                	</group>
            	</search> 
           	</field>
        </record>

    </data>
</openerp>